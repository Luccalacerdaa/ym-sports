name: üîî Push Notifications Autom√°ticas

on:
  schedule:
    # Hor√°rios em UTC (Bras√≠lia = UTC-3)
    # 07:00 BRT = 10:00 UTC
    - cron: '0 10 * * *'
    # 08:30 BRT = 11:30 UTC
    - cron: '30 11 * * *'
    # 12:00 BRT = 15:00 UTC
    - cron: '0 15 * * *'
    # 15:30 BRT = 18:30 UTC
    - cron: '30 18 * * *'
    # 18:30 BRT = 21:30 UTC
    - cron: '30 21 * * *'
    # 20:00 BRT = 23:00 UTC
    - cron: '0 23 * * *'
  
  # Permitir execu√ß√£o manual
  workflow_dispatch:

jobs:
  send-notifications:
    name: Enviar Notifica√ß√µes Agendadas
    runs-on: ubuntu-latest
    
    steps:
      - name: üì§ Chamar endpoint de notifica√ß√µes
        run: |
          curl -X POST \
            https://ym-sports.vercel.app/api/scheduled-push \
            -H "Content-Type: application/json" \
            -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
            -d '{"secret": "${{ secrets.CRON_SECRET }}"}'
      
      - name: ‚úÖ Notifica√ß√£o enviada
        run: echo "Notifica√ß√£o agendada enviada com sucesso!"
